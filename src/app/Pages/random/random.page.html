<ion-content>
  <div class="container">
    <div class="language-container" (click)="pressLanguage()">
      <ion-text color="medium"><p class="ion-no-margin language">{{ 'random.language' | translate }}</p></ion-text>
    </div>
    <div class="top" *ngIf="film !== undefined">
      <ion-text color="primary">
        <h2 class="title">{{truncStr(film.title, 22)}} ({{film.release_date.split('-')[0]}})</h2>
      </ion-text>
      <div class="poster-container">
        <ion-img class="poster" [src]="(filmImage)"></ion-img>
      </div>
      <div class="details-container">
        <ion-text color="medium" *ngIf="film.tagline !== ''"><h5 class="ion-no-margin details-tagline">{{ film.tagline }}</h5></ion-text>
        <ion-text color="medium"><p class="ion-no-margin small-detail">{{ filmGenres.join(", ") }}</p></ion-text>
        <ion-text color="medium"><p class="ion-no-margin small-detail">{{ film.runtime }} min.</p></ion-text>
      </div>
      <div class="details-button-container">
        <ion-button class="btn__details" color="tertiary" size="small" [routerLink]="['/details-film', film.id]" routerDirection="forward">{{ 'random.details' | translate }}</ion-button>
      </div>
    </div>
    <div class="bottom">
      <div class="buttons">
        <ion-grid class="ion-no-margin">
          <ion-row>
            <ion-col size="3">
              <ion-button class="btn" expand="block" color="tertiary" (click)="pressFiltersButton()"><ion-icon name="funnel"></ion-icon></ion-button>
            </ion-col>
            <ion-col>
              <ion-button class="btn" expand="block" (click)="pressRandom()">{{ 'random.randomfilm' | translate }}</ion-button>
            </ion-col>
          </ion-row>
        </ion-grid>
      </div>
    </div>
    <div class="filters-modal" *ngIf="filtersModalOpened">
      <div class="filters-back" (click)="pressFiltersButton()">
        <ion-icon class="filters-back__icon" name="arrow-back" color="medium"></ion-icon>
      </div>
      <div class="filters-container">
        <div class="filters-header ion-no-padding">
          <ion-text color="primary"><h1> {{ 'random.filters' | translate }} </h1></ion-text>
        </div>
        <div class="filters-scroll-container">
          <div class="filters-scroll">
            <div class="filters">
              <ion-grid>
                <div class="filter" *ngFor="let forToFilter of forToFiltersNames; index as i">
                  <ion-row>
                    <ion-col>            
                      <div class="filter-name" (click)="pressFilter(i)"><ion-checkbox class="filter-checkbox" [checked]="filterActiveArr[i]"></ion-checkbox><h4> {{ 'random.' + forToFiltersNames[i][0] | translate }}</h4></div>
                    </ion-col>
                  </ion-row>
                  <ion-row *ngIf="filterActiveArr[i]">
                    <ion-col>
                      <div class="filter-option-container">
                        <div class="filter-option-decorator"><div class="filter-option-decorator__pointer"></div></div>
                        <ion-text class="filter-option-text">{{ 'random.from' | translate }}</ion-text><ion-button color="tertiary" class="filter-option-button" (click)="showDoublePicker(forToFiltersNames[i][1])">{{ filters[i][0] }}</ion-button>
                        <ion-text class="filter-option-text">{{ 'random.to' | translate }}</ion-text><ion-button color="tertiary" class="filter-option-button" (click)="showDoublePicker(forToFiltersNames[i][1])">{{ filters[i][1] }}</ion-button>
                      </div>
                    </ion-col>
                  </ion-row>
                </div>
                <div class="filter">
                  <ion-row>
                    <ion-col>            
                      <div class="filter-name" (click)="pressFilter(3)"><ion-checkbox class="filter-checkbox" [checked]="filterActiveArr[3]"></ion-checkbox><h4> {{ 'random.originallanguage' | translate }} </h4></div>
                    </ion-col>
                  </ion-row>
                  <ion-row *ngIf="filterActiveArr[3]">
                    <ion-col>
                      <div class="filter-option-container">
                        <div class="filter-option-decorator"><div class="filter-option-decorator__pointer"></div></div>
                        <ion-button color="tertiary" class="filter-option-button" (click)="showPicker('language')">{{ 'random.languages.' + filters[3][0] | translate }}</ion-button>
                      </div>
                    </ion-col>
                  </ion-row>
                </div>
                <div class="filter">
                  <ion-row>
                    <ion-col>
                      <div class="filter-header">
                        <div class="filter-name"><h4> {{ 'random.genres' | translate }} </h4></div>
                        <div class="filter-selectAll" *ngIf="!deselectAll" (click)="setAllGenres(true)"><h5>{{ 'random.selectall' | translate }}</h5></div>
                        <div class="filter-selectAll" *ngIf="deselectAll" (click)="setAllGenres(false)"><h5>{{ 'random.deselectall' | translate }}</h5></div>
                      </div>
                    </ion-col>
                  </ion-row>
                  <ion-row *ngIf="genres !== undefined">
                    <ion-col>
                      <div class="filter-option-container--alwaysVisible">
                        <div class="genres-container">
                          <div class="genre" *ngFor="let genre of genres; index as i" (click)="pressGenre(i)">
                            <ion-checkbox class="filter-checkbox" [checked]="selectedGenres[i]"></ion-checkbox><h5> {{ genre.name }} </h5>
                          </div>
                        </div>
                      </div>
                    </ion-col>
                  </ion-row>
                </div>
              </ion-grid>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="error-modal-container" *ngIf="errorModalOpened" (click)="showErrorModal()">
      <div class="error-modal">
        <ion-text class="error-title"><h3> Nothing found :( </h3></ion-text>
        <ion-text><h5> Try again with less restrictive filters. </h5></ion-text>
      </div>
    </div>
    <div class="filters-backdrop" *ngIf="filtersModalOpened || errorModalOpened"></div>
  </div>
</ion-content>
